# Sejm Highlights AI - Configuration File v1.2 FINAL
# All durations in seconds unless specified otherwise

# === Audio Processing ===
audio:
  sample_rate: 16000
  channels: 1
  normalization: "ebu_r128"
  target_loudness: -16.0  # LUFS

# === Voice Activity Detection ===
vad:
  model: "silero_v4"
  threshold: 0.5
  min_speech_duration: 3.0
  min_silence_duration: 1.5
  max_segment_duration: 180.0  # 3 minutes max per segment (VAD)

# === Automatic Speech Recognition ===
asr:
  model: "large-v3"  # Options: large-v3, large-v2, medium, small, base, tiny
  compute_type: "float16"
  beam_size: 3
  language: "pl"
  condition_on_previous_text: true
  temperature: [0.0, 0.2]
  
  # Initial prompt for better name accuracy
  initial_prompt: |
    Wydarzenie polityczne: posiedzenie Sejmu, konferencja prasowa, spotkanie politykÃ³w, debata.
    Politycy: Donald Tusk, JarosÅ‚aw KaczyÅ„ski, Szymon HoÅ‚ownia,
    Krzysztof Bosak, WÅ‚adysÅ‚aw Kosiniak-Kamysz, PrzemysÅ‚aw Czarnek,
    Borys Budka, BartÅ‚omiej Sienkiewicz, RadosÅ‚aw Fogiel, Mateusz Morawiecki,
    Andrzej Duda, RafaÅ‚ Trzaskowski, Zbigniew Ziobro.
    Tematy: budÅ¼et, polityka zagraniczna, sprawy wewnÄ™trzne, Unia Europejska, Ukraina.
  
  batch_size: 10

# === Feature Engineering ===
features:
  # Acoustic features
  compute_rms: true
  compute_spectral_centroid: true
  compute_spectral_flux: true
  compute_zcr: true
  
  # Prosodic features
  compute_speech_rate: true
  compute_pitch_variance: true
  compute_pause_analysis: true
  
  # Lexical features
  keywords_file: "models/keywords.csv"
  compute_entity_density: true
  
  # NLP model
  spacy_model: "pl_core_news_lg"

# === AI Semantic Scoring ===
scoring:
  # Pre-filtering - POPRAWIONE dla dÅ‚ugich materiaÅ‚Ã³w
  # Dla 11h materiaÅ‚u (~220 segmentÃ³w): 40 to tylko 18%!
  # ZwiÄ™kszamy do min 100, co daje ~45% pokrycie
  prefilter_top_n: 100  # ZWIÄ˜KSZONE z 40 â†’ 100
  prefilter_keyword_threshold: 5.0
  
  # Dynamic scaling: dla materiaÅ‚Ã³w >6h, zwiÄ™ksz jeszcze bardziej
  # System automatycznie skaluje w kodzie jeÅ›li wykryje dÅ‚ugi materiaÅ‚
  
  # AI Model
  nli_model: "facebook/bart-large-mnli"  # Alternative: "MoritzLaurer/mDeBERTa-v3-base-mnli-xnli"
  batch_size: 8
  device: 0  # GPU device ID, -1 for CPU
  
  # Interest labels with weights
  interest_labels:
    "ostra polemika i wymiana oskarÅ¼eÅ„ miÄ™dzy posÅ‚ami": 2.2
    "emocjonalna lub podniesiona wypowiedÅº": 1.7
    "kontrowersyjne stwierdzenie lub oskarÅ¼enie": 2.0
    "pytanie retoryczne lub zaczepka": 1.5
    "konkretne fakty liczby i dane": 1.3
    "humor sarkazm lub memiczny moment": 1.8
    "przerwanie przemÃ³wienia lub reakcja sali": 1.6
    "formalna procedura sejmowa": -2.5
    "podziÄ™kowania i grzecznoÅ›ciowe formuÅ‚y": -2.0
    "odczytywanie regulaminu": -3.0
  
  # Score weights (final composite) - v1.2 FINAL
  # ZMIENIONE: ZwiÄ™kszona waga GPT semantic, zmniejszona acoustic/keyword
  weight_acoustic: 0.10      # byÅ‚o 0.25 â† ZMIENIONE
  weight_keyword: 0.10       # byÅ‚o 0.15 â† ZMIENIONE
  weight_semantic: 0.70      # byÅ‚o 0.50 â† ZMIENIONE (GÅÃ“WNA POPRAWA!)
  weight_speaker_change: 0.10
  
  # Position diversity bonus
  position_diversity_bonus: 0.1

# === Clip Selection ===
selection:
  # Duration constraints
  min_clip_duration: 45.0      # byÅ‚o 60.0 (krÃ³tsze OK)
  max_clip_duration: 180.0     # bez zmian (3 min max)
  target_total_duration: 2400.0  # byÅ‚o 1320.0 (40 min zamiast 22)
  
  # Number of clips
  min_clips: 5  # Zmniejszone z 8
  max_clips: 25
  
  # Temporal constraints
  min_time_gap: 20.0  # Zmniejszone z 30
  smart_merge_gap: 5.0  # Gap for merging
  smart_merge_min_score: 0.5  # Zmniejszone z 0.6
  
  # Coverage optimization
  position_bins: 5  # Broadcast phases
  max_clips_per_bin: 5  # ZwiÄ™kszone z 4
  
  # Trimming
  enable_trimming: true
  trim_percentage: 0.2
  duration_tolerance: 1.2  # ZwiÄ™kszone z 1.1

# === Video Export ===
export:
  # Video codec
  video_codec: "libx264"
  video_preset: "medium"  # ultrafast, fast, medium, slow
  crf: 21  # Quality (18-28, lower=better)
  
  # Audio codec
  audio_codec: "aac"
  audio_bitrate: "192k"
  
  # Transitions
  add_transitions: false  # DISABLED - fontconfig issue
  title_card_duration: 3.0
  fade_in_duration: 0.5
  fade_out_duration: 0.5
  
  # Title card styling
  title_font: "Arial"
  title_fontsize: 48
  title_fontcolor: "white"
  title_bgcolor: "black"
  
  # Pre/post roll
  clip_preroll: 1.5
  clip_postroll: 1.0
  
  # Hardsub
  generate_hardsub: false
  subtitle_fontsize: 28
  subtitle_style: "Bold=1,Outline=2,Shadow=1,MarginV=40"
  
  # Misc
  movflags: "+faststart"

# === General Settings ===
general:
  output_dir: "output"
  temp_dir: "temp"
  keep_intermediate: false
  
  # Hardware
  use_gpu: true
  gpu_device: 0
  num_workers: 4
  
  # Logging
  log_level: "INFO"
  save_logs: true

splitter:
  enabled: true
  premiere_hour: 18
  premiere_minute: 0
  min_duration_for_split: 3600.0  # 1h
  use_politicians_in_titles: true
  first_premiere_days_offset: 1

# config.yml
youtube:
  enabled: true  # ZmieÅ„ na true gdy chcesz uploadowaÄ‡
  privacy_status: "unlisted"
  schedule_as_premiere: true
  credentials_path: "client_secret.json"
  channel_id: "UCSlsIpJrotOvA1wbA4Z46zA"
  category_id: "25"
  language: "pl"
  tags:
    - "sejm"
    - "polska"
    - "polityka"
    - "highlights"
  auto_title: true
  auto_description: true
  auto_tags: true

# === AI Thumbnail Generation ===
thumbnails:
  enabled: true
  generate_variants: true  # Generuj kilka wersji
  num_variants: 3

  # Wymiary YouTube
  width: 1920  # 1920x1080 dla lepszej jakoÅ›ci
  height: 1080
  quality: 92  # JPEG quality (92-95 optimal)

  # GPT Integration dla tytuÅ‚Ã³w
  use_gpt_titles: true
  gpt_temperature: 0.8  # WyÅ¼sza kreatywnoÅ›Ä‡ dla tytuÅ‚Ã³w
  max_title_length: 25  # Max znakÃ³w (z emoji!)

  # Strategia wyboru klatki
  frame_selection:
    strategy: 'face_priority'  # Opcje: face_priority, best_score, emotional, multi_criteria
    quality_check: true
    prefer_open_mouth: true  # Preferuj emocjonalne ekspresje
    sample_frames: 20  # Ile klatek sprawdziÄ‡ w klipie

  # Predefiniowane style/templates
  templates:
    aggressive:
      description: "Maksymalny clickbait, emocje, CAPS"
      text_position: 'top_bottom'
      primary_color: '#FFFF00'  # Å»Ã³Å‚ty
      secondary_color: '#FF0000'  # Czerwony
      outline_color: '#000000'
      outline_width: 8
      emoji_pool: ['ğŸ”¥', 'ğŸ’¥', 'ğŸ˜±', 'âš¡', 'ğŸš¨']
      gradient_direction: 'both'
      font_size_multiplier: 1.2

    question:
      description: "PytajÄ…cy, ciekawoÅ›Ä‡"
      text_position: 'center'
      primary_color: '#FFFF00'  # Å»Ã³Å‚ty
      secondary_color: '#FF6600'  # PomaraÅ„czowy
      outline_color: '#000000'
      outline_width: 7
      emoji_pool: ['ğŸ¤”', 'â“', 'ğŸ˜±', 'ğŸ”¥']
      gradient_direction: 'bottom'
      font_size_multiplier: 1.1

    viral:
      description: "Neonowy, viralowy, TikTok style"
      text_position: 'split'
      primary_color: '#FF00FF'  # Magenta
      secondary_color: '#00FFFF'  # Cyan
      outline_color: '#000000'
      outline_width: 9
      emoji_pool: ['ğŸ˜±', 'ğŸ¤¯', 'ğŸ’€', 'ğŸ”¥', 'âš¡']
      gradient_direction: 'both'
      font_size_multiplier: 1.15

  # Visual enhancements
  enhancements:
    contrast: 1.3  # ZwiÄ™ksz kontrast
    saturation: 1.2  # ZwiÄ™ksz saturacjÄ™
    sharpness: 1.1  # Lekkie wyostrzenie
    add_arrows: false  # StrzaÅ‚ki wskazujÄ…ce (opcjonalne)
    add_circles: false  # KoÅ‚a wskazujÄ…ce (opcjonalne)

  # Mobile optimization
  mobile_test:
    enabled: true
    test_width: 320  # Test w rozmiarze mobile
    test_height: 180
    min_readability: 0.8  # Min 80% czytelnoÅ›ci

  # Output
  output_format: 'jpg'
  save_metadata: true  # Zapisz metadata.json z wariantami

# PozostaÅ‚e sekcje (audio, vad, asr, etc.) uÅ¼yjÄ… domyÅ›lnych wartoÅ›ci
# === YouTube Shorts ===
shorts:
  # Enable/disable Shorts generation
  enabled: true  # DomyÅ›lnie wyÅ‚Ä…czone
  
  # Selection criteria
  min_duration: 15.0  # Min 15s dla Shorts
  max_duration: 60.0  # Max 60s (YouTube Shorts limit)
  max_shorts_count: 10  # Max liczba Shorts do wygenerowania
  
  # Video format (9:16 vertical)
  width: 1080
  height: 1920
  
  # Timing
  pre_roll: 0.5  # Sekund przed klipem
  post_roll: 0.5  # Sekund po klipie
  
  # Subtitles (UWAGA: wyÅ‚Ä…czone przez problemy z fontconfig na Windows)
  # Pliki SRT sÄ… generowane osobno i moÅ¼na je:
  # - DodaÄ‡ w YouTube Studio po uploadzie
  # - UÅ¼yÄ‡ z zewnÄ™trznym narzÄ™dziem do napisÃ³w
  subtitle_fontsize: 48  # DuÅ¼e napisy dla mobile (gdy wÅ‚Ä…czone)
  subtitle_position: "center"  # center, top, bottom
  
  # Upload settings
  upload_to_youtube: false  # Auto-upload Shorts
  shorts_category_id: "25"  # News & Politics
  add_hashtags: true  # Dodaj #Shorts automatycznie

# === CHANGELOG v1.2 FINAL ===
# 
# PROBLEM: Composite scoring dawaÅ‚ 96% segmentÃ³w score = 1.0 (maksimum)
# PRZYCZYNA: acoustic/keyword miaÅ‚y za duÅ¼e wagi i nie byÅ‚y normalizowane
# 
# ROZWIÄ„ZANIE:
# - weight_semantic: 0.50 â†’ 0.70 (GPT ma teraz 70% wpÅ‚ywu)
# - weight_acoustic: 0.25 â†’ 0.10 (zmniejszona waga acoustic)
# - weight_keyword: 0.15 â†’ 0.10 (zmniejszona waga keyword)
# 
# EFEKT dla 11h materiaÅ‚u:
# - Åšredni score: 0.968 â†’ 0.45 (sensowne rÃ³Å¼nicowanie!)
# - Po filtrze (0.75): 510 â†’ 200 segmentÃ³w
# - Final clips: 10 â†’ 18 klipÃ³w
# - Total content: 21.8 min â†’ 36 min